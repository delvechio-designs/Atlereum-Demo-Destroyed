from rest_framework import serializers
from .models import Message
from orders.serializers import OfferSerializer


class MessageSerializer(serializers.ModelSerializer):
    offer = OfferSerializer()
    sender = serializers.SerializerMethodField()
    receiver = serializers.SerializerMethodField()

    class Meta:
        model = Message
        fields = [
            "room",
            "sender",
            "receiver",
            "offer",
            "content",
            "created_at",
        ]

    def get_sender(self, instance):
        return instance.sender.username

    def get_receiver(self, instance):
        return instance.receiver.username
