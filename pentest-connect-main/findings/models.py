from django.db import models
from django.contrib.auth import get_user_model

User = get_user_model()

# Create your models here. 

class Finding(models.Model):
    title = models.CharField(max_length=255)
    description = models.TextField()
    severity = models.CharField(max_length=50)
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    pentest = models.ForeignKey("pentests.Pentest", on_delete=models.CASCADE, related_name="findings")
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        ordering = ["-updated_at", "-created_at"]

    def __str__(self) -> str:
        return f"{self.title} - {self.pentest.id}"

# class Remediation(db.Model):
#     id = db.Column(db.Integer, primary_key=True)
#     finding_id = db.Column(db.Integer, db.ForeignKey('finding.id'), nullable=False)
#     finding = db.relationship('Finding', backref=db.backref('remediations', lazy=True))
#     description = db.Column(db.String(500), nullable=False)
#     status = db.Column(db.String(50), nullable=False)